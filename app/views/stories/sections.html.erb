<% title @story.title.titlecase.html_safe %>


<div class='row'>
  <div class='col-md-3'>
   <div id='toolbar' class='clear'>
      <div class="btn-group">
        <button type="button" id='btnAddSection' class="btn btn-primary" title="<%= t('app.buttons.add_section') %>"><i class="glyphicon glyphicon-align-justify"></i></button>
        <button type="button" id='btnAddItem' class="btn btn-primary" title="<%= t('app.buttons.add_item') %>"><i class="glyphicon glyphicon-film" ></i></button>
        <button type="button" id='btnDelete' class="btn  btn-danger" title="<%= t('app.buttons.delete') %>" ><i class="glyphicon glyphicon-remove" >
          
        </i></button>
        <button type="button" id='btnUp' class="btn btn-info" title="<%= t('app.buttons.up') %>"> <i class="glyphicon glyphicon-arrow-up" ></i> </button>
        <button type="button" id='btnDown' class="btn btn-info" title="<%= t('app.buttons.down') %>"> <i class="glyphicon glyphicon-arrow-down" ></i></button>
        <button type="button"  id='btnPublish' class="btn btn-warning <%= @story.published ? '' : ' disabled'%>" title="<%= @story.published ? t('app.buttons.unpublish') : t('app.buttons.publish') %>" data-link='<%= publish_story_path(@story) %>'> <i class="glyphicon glyphicon-globe" ></i></button>     

         <button type="button"  id='btnPreview' class="btn btn-success preview" title="<%= t('app.buttons.preview') %>" data-link='<%=  preview_story_path(@story) %>'
          data-modalos-id='modalos-preview' data-type="story"> <i class="glyphicon glyphicon-eye-open" ></i></button>            
      </div>
    </div>
  </div>
</div>

<div class='row'>
  <div class='col-md-3'>   
 
    <div class='story-tree' id='<%= @story.id %>'>        
      <ul>
          <% @story.sections.each do |item| %>          
              <li id='<%= item.id %>' data-type='<%= item.get_str_type %>' class='item'><span><%= item.title %></span>                  
                  <% if item.content? && item.content.present? %>
                    <ul><li id='<%= item.content.id %>' class='sub'><span><%= item.content.title %></span></li></ul>
                  <% elsif item.media? && item.media.present? %>
                    <ul>
                        <% item.media.each do |subitem| %>                  
                        <li id='<%= subitem.id %>' class='sub'><span><%= subitem.title %></span></li>
                      <%end%>
                    </ul>
                   <% elsif item.slideshow? && item.slideshow.present? %>
                     <ul><li id='<%= item.slideshow.id %>' class='sub'><span><%= item.slideshow.title %></span></li></ul>
                   <% elsif item.embed_medium.present? %>
                      <ul><li id='<%= item.embed_medium.id %>' class='sub'><span><%= item.embed_medium.title %></span></li></ul>
                  <%end%>
              </li>          
          <% end %>            
      </ul>  
    </div>
    &nbsp;    
  </div>  
  <div class='col-md-9 story-viewer' id='storyViewer'></div>

</div>

<div id="modalos-preview" style="display:none;width:100%;height:100%;"></div>

<!-- <div id="modalVideo" class="reveal-modal" style='width:853px; height:480px'>   
    <div class='modal-data'>  
        <video preload="auto" width="853px" height="480px" controls>
        <%= t('layouts.unsupported_browser.video') %>            
        </video>
      </div>     
     <a class="close-reveal-modal">&#215;</a>
</div>


<div id="modalImage" class="reveal-modal">     
      <div class='modal-data'></div>
      <a class="close-reveal-modal">&#215;</a>
</div>
<div id="modalContent" class="reveal-modal">     
      <div class='modal-data'></div>
      <a class="close-reveal-modal">&#215;</a>
</div>
 -->
